# Microservices Deployment Project (Docker, Swarm, Vagrant)  #  
### Практический проект по развёртыванию микросервисного приложения с использованием контейнеризации, оркестрации и автоматизации инфраструктуры. ###

###  Поставленные цели ###
- Освоить контейнеризацию микросервисов с помощью Docker.
- Научиться создавать оптимизированные multi-stage Dockerfile для Java-сервисов.
- Запустить приложение через Docker Compose на одной машине.
- Создать виртуальную инфраструктуру с использованием Vagrant и VirtualBox.
- Развернуть кластер Docker Swarm (1 manager + 2 worker).
- Запустить микросервисное приложение как стек в распределённой среде.
- Настроить reverse-proxy на базе nginx.
- Визуализировать работу кластера через Portainer.
- Закрепить навыки работы с контейнерами, сетями Docker и оркестрацией.

### Инструменты и технологии ###
- **Docker/Docker-compose**  
- **Multi-stage Dockerfile**  
- **Docker Swarm** - распределённый кластер
- **Vagrant + VirtualBox** - автоматизация создания ВМ  
- **Ansible** - автоматизация конфигурации узлов
- **Portainer** - UI для управления Swarm  

## Структура проекта ##
- `report.md` - подробный отчёт проделенной работы с командами и скриншотами.  
- `services/` - исходные микросервисы + Dockerfile.  
- `scripts/` - Bash-скрипты для установки Docker и инициализации Swarm.
- `ansible/` - файлы для использования автоматизации с использованием Ansible.  
- `docker-compose.yaml` - Стэк микросервисов.  
- `docker-compose-proxy.yaml` - Nginx прокси.
- `docker-compose-portainer.yaml` - Стэк Portainer в Swarm.  
- `nginx.conf` - Nginx прокси.  
- `Vagrantfile` - Описание инфраструктуры из 3-х ВМ



## Содержание отчета ##
**Part 1. Docker Compose**   
- Созданы multi-stage Dockerfile для всех микросервисов.  
- Настроен `docker-compose.yaml` с зависимостями, healthcheck и resource limits.  
- Проверено локальное развёртывание.

**Part 2. Создание виртуальных машин**
- Созданы 3 ВМ (manager, worker01, worker02).  
- Настроено монтирование проекта и автоматизация установки Docker.
- Реализована дополнительная автоматизация подготовки и запуска приложения на удалённых узлах с помощью Ansible.

**Part 3. Создание Docker Swarm**
- Развёрнут кластер Swarm используя созданные ВМ.

**Part 4. Запуск в инфраструктуре**
- Образы опубликованы в Docker Hub.
- Приложение запущено как стек через docker `stack deploy`.


**Part 5. Прокси на базе nginx**  
- Настроен nginx для маршрутизации к `gateway-service` и `session-service`.  
- Убраны лишние пробросы портов, оставлен только proxy.  

**Part 6. Тестирование**
- Проверено выполнение тестов Postman локально и в кластере через proxy.

**Part 7. Portainer**  
- Добавлен стек Portainer для визуального наблюдения за кластером.

## Дополнительная автоматизация

В проекте также используется Ansible для удалённого конфигурирования узлов:
- установка Docker и Docker Compose
- копирование docker-compose.yaml и исходного кода
- запуск микросервисного приложения
- проверка состояния контейнеров

Ansible применяется как альтернативный способ автоматизации
в дополнение к Bash-скриптам и Vagrant provisioning.

## Выводы ##
- Освоена контейнеризация микросервисной архитектуры.  
- Реализованы оптимизированные multi-stage Dockerfile.  
- Настроена инфраструктура из нескольких виртуальных машин с помощью Vagrant.  
- Развёрнут распределённый кластер Docker Swarm.  
- Микросервисное приложение успешно запущено в виде стека.  
- Настроен reverse proxy на базе nginx.  
- Добавлен Portainer для мониторинга, что упростило управление кластером.  
- Проверена доступность и корректность работы через Postman.  
